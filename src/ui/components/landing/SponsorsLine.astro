<div class="container">
  <div>
    <div class="title">Our Sponsors</div>
    <div class="description">You help us build a better future</div>
  </div>
  <div class={"wrapper"}>
    <div id="sponsors-scroll" class={"scroll"}>
      <div class="railway-section">
        <header class="sponsors_header">
          <div class="type_header">
            <span class="emoji">üåßÔ∏è</span>
            <span>Cloud Partners</span>
          </div>
        </header>
        <a
          class="railway-banner"
          href="https://driz.link/railway"
          target="_blank"
          rel="nofollow noreferrer"
        >
          <div class="railway-banner_content">
            <canvas class="railway-rain" id="railway-rain-canvas"></canvas>
            <div class="railway-banner_logo">
              <img
                class="railway-logo-dark"
                src="/svg/railway-sidebar.svg"
                alt="Railway"
                loading="lazy"
              />
              <img
                class="railway-logo-light"
                src="/svg/railway-sidebar-light.svg"
                alt="Railway"
                loading="lazy"
              />
            </div>
            <div class="railway-banner_badge">Our Cloud Partner</div>
          </div>
        </a>
      </div>
    </div>
    <div class={"gradient-left"}></div>
    <div class={"gradient-right"}></div>
  </div>
  <a
    class="sponsors_button_accent"
    href="https://driz.link/sponsor"
    target="_blank"
    rel="nofollow noreferrer"
  >
    Become a sponsor
  </a>
</div>

<template id="sponsor-cards">
  <div class={"sponsors"}>
    <header class={"sponsors_header"}>
      <div class={"type_header"}>
        <span class={"emoji"} id="emoji"></span>
        <span id="header-text"></span>
      </div>
    </header>
    <div id="cards-block"></div>
  </div>
</template>

<template id="sponsor-card-with-name">
  <a id="git-link" href={`https://github.com/`} target="_blank" rel="nofollow">
    <div id="card-wrapper">
      <div id="img-wrapper" class={"card_image"}>
        <img id="avatar-dark" loading="lazy" />
        <img id="avatar-light" loading="lazy" />
      </div>
      <div id="card-name" class={"card_name"}></div>
      <div class="popover"></div>
    </div>
  </a>
</template>

<template id="sponsor-card-without-name">
  <a id="git-link" href={`https://github.com/`} target="_blank" rel="nofollow">
    <div class={"avatar"}>
      <div id="img-wrapper" class={"card_image"}>
        <img id="avatar-dark" loading="lazy" />
        <img id="avatar-light" loading="lazy" />
      </div>
    </div>
  </a>
</template>
<script>
  import { sponsorsHandler } from "@/utils-client";
  import { sponsorConfig } from "@/data/sponsor-config";
  import { ImageType } from "@/types";
  import type { CSSProperties } from "react";

  document.addEventListener("astro:page-load", async () => {
    const sponsorLinks = {
      unkeyed: "unkey.dev",
      wakatime: "wakatime.com",
      nodecraft: "nodecraft.com",
      devhuset: "devhuset.no",
      un: "driz.link/silver-sponsor-uninbox",
      encoredev: "driz.link/silver-sponsor-encore",
    };

    const customName = {
      un: "Uninbox",
    };

    const getStyleString = (style: CSSProperties) => {
      return Object.keys(style).reduce((acc, key) => {
        return acc + `${key}: ${style[key as keyof CSSProperties]};`;
      }, "");
    };
    const sponsors = await sponsorsHandler();
    const sponsorsScroll = document.querySelector("#sponsors-scroll");
    const getImgLink = (link: string, size: number) => {
      return link.split("?")[0] + "?size=" + size * 2;
    };
    //templates
    const sponsorCardsTemplate = document.querySelector(
      "#sponsor-cards",
    ) as HTMLTemplateElement;
    const sponsorCardWithNameTemplate = document.querySelector(
      "#sponsor-card-with-name",
    ) as HTMLTemplateElement;
    const sponsorCardWithoutNameTemplate = document.querySelector(
      "#sponsor-card-without-name",
    ) as HTMLTemplateElement;
    if (
      sponsorCardsTemplate &&
      sponsorCardWithNameTemplate &&
      sponsorCardWithoutNameTemplate &&
      sponsorsScroll
    ) {
      sponsors.forEach((type) => {
        if (type.items.length) {
          const cards = sponsorCardsTemplate.content.cloneNode(
            true,
          ) as HTMLElement;
          const headerName = cards.querySelector("#header-text")!;
          headerName.textContent = `${sponsorConfig[type.name].header} sponsors`;
          const emoji = cards.querySelector("#emoji")!;
          emoji.textContent = sponsorConfig[type.name].emoji;
          const cardsBlock = cards.querySelector("#cards-block")!;
          cardsBlock.className = `${type.name} cards`;
          type.items.forEach((item) => {
            if (sponsorConfig[type.name].hasName) {
              //WITH NAME
              const card = sponsorCardWithNameTemplate.content.cloneNode(
                true,
              ) as HTMLDivElement;

              //dark image
              const imgDark = card.querySelector(
                "#avatar-dark",
              )! as HTMLImageElement;
              if (item.imageType === ImageType.IMAGE) {
                imgDark.src = item.sponsorEntity.avatarUrl;
              }
              if (item.imageType === ImageType.SVG) {
                imgDark.src =
                  "data:image/svg+xml;base64," +
                  btoa(item.sponsorEntity.avatarUrl);
              }
              if (!item.imageType) {
                imgDark.src = getImgLink(
                  item.sponsorEntity.avatarUrl,
                  sponsorConfig[type.name].size,
                );
              }
              imgDark.alt = item.sponsorEntity.name || item.sponsorEntity.login;
              const roundPercentages =
                item.sponsorEntity.__typename === "User" ? 50 : 20;
              imgDark.setAttribute(
                "style",
                `border-radius: ${roundPercentages}%; ${getStyleString(
                  item.darkStyle || {},
                )}`,
              );

              //light image

              const imgLight = card.querySelector(
                "#avatar-light",
              )! as HTMLImageElement;
              if (item.imageType === ImageType.IMAGE) {
                imgLight.src = item.sponsorEntity.avatarUrl;
              }
              if (item.imageType === ImageType.SVG) {
                imgLight.src =
                  "data:image/svg+xml;base64," +
                  btoa(item.sponsorEntity.avatarUrl);
              }
              if (!item.imageType) {
                imgLight.src = getImgLink(
                  item.sponsorEntity.avatarUrl,
                  sponsorConfig[type.name].size,
                );
              }
              imgLight.alt =
                item.sponsorEntity.name || item.sponsorEntity.login;
              imgLight.setAttribute(
                "style",
                `border-radius: ${roundPercentages}%; ${getStyleString(
                  item.lightStyle || {},
                )}`,
              );

              const imgWrapper = card.querySelector(
                "#img-wrapper",
              )! as HTMLDivElement;
              imgWrapper.setAttribute(
                "style",
                `width: ${sponsorConfig[type.name].size}px; height: ${
                  sponsorConfig[type.name].size
                }px`,
              );
              const gitLink = card.querySelector(
                "#git-link",
              )! as HTMLLinkElement;
              if (item.imageType) {
                gitLink.href = `https://${item.sponsorEntity.login}`;
              } else {
                if (
                  sponsorLinks[
                    item.sponsorEntity.login as keyof typeof sponsorLinks
                  ]
                ) {
                  gitLink.href = `https://${
                    sponsorLinks[
                      item.sponsorEntity.login as keyof typeof sponsorLinks
                    ]
                  }`;
                } else {
                  gitLink.href = `https://github.com/${item.sponsorEntity.login}`;
                }
              }
              gitLink.rel = item.followLink ? "" : "nofollow";
              const cardName = card.querySelector(
                "#card-name",
              )! as HTMLDivElement;
              if (item.sponsorEntity.name) {
                cardName.textContent =
                  customName[
                    item.sponsorEntity.login as keyof typeof customName
                  ] || item.sponsorEntity.name;
                if (item.sponsorEntity.name === "SQLite Cloud") {
                  cardName.style.fontSize = "12px";
                }
              } else {
                cardName.textContent =
                  item.sponsorEntity.__typename === "User"
                    ? "@" + item.sponsorEntity.login
                    : "" + item.sponsorEntity.login;
              }
              const cardWrapper = card.querySelector(
                "#card-wrapper",
              )! as HTMLDivElement;
              cardWrapper.classList.add("with_name");
              if (sponsorConfig[type.name].hasCard) {
                if (item.popover) {
                  cardWrapper.classList.add("styled_card_with_popover");
                  const popover =
                    cardWrapper.querySelector<HTMLDivElement>(".popover");
                  if (popover) {
                    popover.innerHTML = item.popover;
                  }
                }
                cardWrapper.classList.add("styled_card");
              }
              cardsBlock.append(card);
            } else {
              //WITHOUT NAME
              const card = sponsorCardWithoutNameTemplate.content.cloneNode(
                true,
              ) as HTMLDivElement;

              //dark image
              const imgDark = card.querySelector(
                "#avatar-dark",
              )! as HTMLImageElement;
              const roundPercentages =
                item.sponsorEntity.__typename === "User" ? 50 : 20;
              imgDark.setAttribute(
                "style",
                `border-radius: ${roundPercentages}%`,
              );
              imgDark.setAttribute(
                "style",
                `border-radius: ${roundPercentages}%; ${getStyleString(
                  item.darkStyle || {},
                )}`,
              );
              if (item.imageType === ImageType.IMAGE) {
                imgDark.src = item.sponsorEntity.avatarUrl;
              }
              if (item.imageType === ImageType.SVG) {
                imgDark.src =
                  "data:image/svg+xml;base64," +
                  btoa(item.sponsorEntity.avatarUrl);
              }
              if (!item.imageType) {
                imgDark.src = getImgLink(
                  item.sponsorEntity.avatarUrl,
                  sponsorConfig[type.name].size,
                );
              }
              imgDark.alt = item.sponsorEntity.name || item.sponsorEntity.login;

              //light image
              const imgLight = card.querySelector(
                "#avatar-light",
              )! as HTMLImageElement;
              imgLight.setAttribute(
                "style",
                `border-radius: ${roundPercentages}%`,
              );
              imgLight.setAttribute(
                "style",
                `border-radius: ${roundPercentages}%; ${getStyleString(
                  item.lightStyle || {},
                )}`,
              );
              if (item.imageType === ImageType.IMAGE) {
                imgLight.src = item.sponsorEntity.avatarUrl;
              }
              if (item.imageType === ImageType.SVG) {
                imgLight.src =
                  "data:image/svg+xml;base64," +
                  btoa(item.sponsorEntity.avatarUrl);
              }
              if (!item.imageType) {
                imgLight.src = getImgLink(
                  item.sponsorEntity.avatarUrl,
                  sponsorConfig[type.name].size,
                );
              }
              imgLight.alt =
                item.sponsorEntity.name || item.sponsorEntity.login;

              const imgWrapper = card.querySelector(
                "#img-wrapper",
              )! as HTMLDivElement;
              imgWrapper.setAttribute(
                "style",
                `width: ${sponsorConfig[type.name].size}px; height: ${
                  sponsorConfig[type.name].size
                }px`,
              );
              const gitLink = card.querySelector(
                "#git-link",
              )! as HTMLLinkElement;
              if (item.imageType) {
                gitLink.href = `https://${item.sponsorEntity.login}`;
              } else {
                if (
                  sponsorLinks[
                    item.sponsorEntity.login as keyof typeof sponsorLinks
                  ]
                ) {
                  gitLink.href = `https://${
                    sponsorLinks[
                      item.sponsorEntity.login as keyof typeof sponsorLinks
                    ]
                  }`;
                } else {
                  gitLink.href = `https://github.com/${item.sponsorEntity.login}`;
                }
              }
              gitLink.rel = item.followLink ? "" : "nofollow";
              cardsBlock.append(card);
            }
          });
          sponsorsScroll.append(cards);
        }
      });
    }
  });
</script>
<script is:inline type="module">
  import {
    computePosition,
    shift,
    offset,
  } from "https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.6.8/+esm";

  const computePopovers = () => {
    const cards = document.querySelectorAll(".styled_card_with_popover");
    cards.forEach((card) => {
      const cardPopover = card.querySelector(".popover");

      if (!cardPopover) return;

      computePosition(card, cardPopover, {
        placement: "top",
        middleware: [shift({ padding: 20 }), offset(6)],
        strategy: "fixed",
      }).then(({ x, y }) => {
        Object.assign(cardPopover.style, {
          left: `${x}px`,
          top: `${y}px`,
        });
      });
    });
  };

  document.addEventListener("astro:page-load", () => {
    setTimeout(() => computePopovers(), 50);

    window.removeEventListener("resize", computePopovers, false);
    document.removeEventListener("scroll", computePopovers, false);

    document.addEventListener("scroll", computePopovers);
    window.addEventListener("resize", computePopovers);
  });

  setTimeout(() => computePopovers(), 50);
</script>
<script>
  function initRailwayRain() {
    const canvas = document.getElementById("railway-rain-canvas") as HTMLCanvasElement;
    if (!canvas) return;

    const ctx = canvas.getContext("2d");
    if (!ctx) return;

    const banner = canvas.parentElement!;
    const bannerLink = banner.parentElement! as HTMLAnchorElement;
    const badge = bannerLink.querySelector(".railway-banner_badge") as HTMLElement;

    const dpr = window.devicePixelRatio || 1;
    const ANGLE = -35;
    const SIN_A = Math.sin(ANGLE * (Math.PI / 180));
    const COS_A = Math.cos(ANGLE * (Math.PI / 180));
    const DROP_COUNT = 60;

    let isHovered = false;
    let isVisible = false;
    let targetOpacity = 0.12;
    let currentOpacity = 0.12;
    let flashOpacity = 0;
    let nextFlashTime = 0;
    let animId = 0;
    let isDark = document.documentElement.classList.contains("dark");

    let flickerQueue: { start: number; duration: number; intensity: number }[] = [];

    interface BoltSegment {
      x1: number; y1: number; x2: number; y2: number;
      width: number; depth: number;
    }
    let boltSegments: BoltSegment[] = [];

    interface Drop {
      x: number; y: number;
      length: number; speed: number; opacity: number;
    }
    let drops: Drop[] = [];

    let lw = 0;
    let lh = 0;

    function resize() {
      const rect = banner.getBoundingClientRect();
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      lw = rect.width;
      lh = rect.height;
    }

    function createDrop(): Drop {
      return {
        x: Math.random() * lw,
        y: Math.random() * -lh,
        length: 8 + Math.random() * 16,
        speed: 4 + Math.random() * 6,
        opacity: 0.2 + Math.random() * 0.5,
      };
    }

    // Bolt generation
    function subdivideLine(
      x1: number, y1: number, x2: number, y2: number,
      displacement: number, depth: number, width: number,
      segments: BoltSegment[], iterations: number
    ) {
      if (iterations === 0) {
        segments.push({ x1, y1, x2, y2, width, depth });
        return;
      }
      const mx = (x1 + x2) / 2 + (Math.random() - 0.5) * displacement;
      const my = (y1 + y2) / 2 + (Math.random() - 0.5) * displacement * 0.4;
      subdivideLine(x1, y1, mx, my, displacement / 2, depth, width, segments, iterations - 1);
      subdivideLine(mx, my, x2, y2, displacement / 2, depth, width, segments, iterations - 1);
    }

    function generateBranch(
      x: number, y: number, angle: number,
      length: number, depth: number, segments: BoltSegment[]
    ) {
      if (depth > 3 || length < 8) return;
      const steps = 3 + Math.floor(Math.random() * 3);
      const stepLen = length / steps;
      let cx = x, cy = y;
      const w = Math.max(0.3, 1.5 - depth * 0.4);
      for (let i = 0; i < steps; i++) {
        angle += (Math.random() - 0.5) * 0.6;
        const nx = cx + Math.cos(angle) * stepLen;
        const ny = cy + Math.sin(angle) * stepLen;
        subdivideLine(cx, cy, nx, ny, stepLen * 0.3, depth, w, segments, 2);
        if (Math.random() > 0.7 && depth < 3) {
          const branchAngle = angle + (Math.random() > 0.5 ? 1 : -1) * (0.4 + Math.random() * 0.5);
          generateBranch(nx, ny, branchAngle, length * 0.3, depth + 1, segments);
        }
        cx = nx;
        cy = ny;
      }
    }

    function generateBolt(): BoltSegment[] {
      const segments: BoltSegment[] = [];
      const startX = lw * (0.15 + Math.random() * 0.7);
      const startY = -2;
      const endX = startX + (Math.random() - 0.5) * lw * 0.6;
      const endY = lh * (0.8 + Math.random() * 0.2);

      const trunkPoints: { x: number; y: number }[] = [{ x: startX, y: startY }];
      const mainSteps = 8 + Math.floor(Math.random() * 5);
      let cx = startX, cy = startY;
      for (let i = 1; i <= mainSteps; i++) {
        const t = i / mainSteps;
        cx = startX + (endX - startX) * t + (Math.random() - 0.5) * 45 * (1 - t * 0.3);
        cy = startY + (endY - startY) * t + (Math.random() - 0.5) * 8;
        trunkPoints.push({ x: cx, y: cy });
      }

      for (let i = 0; i < trunkPoints.length - 1; i++) {
        const p1 = trunkPoints[i], p2 = trunkPoints[i + 1];
        subdivideLine(p1.x, p1.y, p2.x, p2.y, 10, 0, 2.2, segments, 2);
      }

      for (let i = 1; i < trunkPoints.length - 1; i++) {
        if (Math.random() > 0.55) {
          const p = trunkPoints[i];
          const next = trunkPoints[i + 1];
          const trunkAngle = Math.atan2(next.y - p.y, next.x - p.x);
          const side = Math.random() > 0.5 ? 1 : -1;
          const branchAngle = trunkAngle + side * (0.3 + Math.random() * 0.7);
          generateBranch(p.x, p.y, branchAngle, 25 + Math.random() * 50, 1, segments);
        }
      }

      return segments;
    }

    function scheduleFlash() {
      // randomize next flash time between 2.5s and 5s
      nextFlashTime = performance.now() + 2500 + Math.random() * 2500;
    }

    function triggerFlicker() {
      flickerQueue = [];
      boltSegments = generateBolt();
      const flickerCount = 1 + Math.floor(Math.random() * 2);
      let offset = 0;
      for (let i = 0; i < flickerCount; i++) {
        const duration = 150 + Math.random() * 200;
        const gap = 80 + Math.random() * 120;
        const intensity = i === 0 ? 0.8 + Math.random() * 0.2 : 0.3 + Math.random() * 0.5;
        flickerQueue.push({ start: performance.now() + offset, duration, intensity });
        offset += duration + gap;
      }
    }

    const themeObserver = new MutationObserver(() => {
      isDark = document.documentElement.classList.contains("dark");
    });
    themeObserver.observe(document.documentElement, { attributes: true, attributeFilter: ["class"] });

    // pause when not visible
    const io = new IntersectionObserver((entries) => {
      const wasVisible = isVisible;
      isVisible = entries[0].isIntersecting;
      if (isVisible && !wasVisible) {
        animId = requestAnimationFrame(draw);
      }
    }, { threshold: 0 });
    io.observe(canvas);

    banner.addEventListener("mouseenter", () => {
      isHovered = true;
      targetOpacity = 0.35;
      scheduleFlash();
    });
    banner.addEventListener("mouseleave", () => {
      isHovered = false;
      targetOpacity = 0.12;
      flashOpacity = 0;
    });

    function draw() {
      if (!isVisible) return;

      ctx!.setTransform(dpr, 0, 0, dpr, 0, 0);
      ctx!.clearRect(0, 0, lw, lh);

      currentOpacity += (targetOpacity - currentOpacity) * 0.06;

      if (isHovered) {
        const now = performance.now();
        if (now >= nextFlashTime && flickerQueue.length === 0) {
          triggerFlicker();
          scheduleFlash();
        }

        flashOpacity = 0;
        flickerQueue = flickerQueue.filter((f) => {
          const elapsed = now - f.start;
          if (elapsed < 0) return true;
          if (elapsed > f.duration) return false;
          const progress = elapsed / f.duration;
          const fade = progress < 0.3 ? progress / 0.3 : 1 - (progress - 0.3) / 0.7;
          flashOpacity = Math.max(flashOpacity, fade * f.intensity);
          return true;
        });

        if (flashOpacity > 0 && isDark) {
          const flashAlpha = flashOpacity * 0.08;
          ctx!.fillStyle = `rgba(255,255,255,${flashAlpha})`;
          ctx!.fillRect(0, 0, lw, lh);

          ctx!.lineCap = "round";
          ctx!.lineJoin = "round";

          const glowPasses = [
            { width: 8, alpha: 0.03 },
            { width: 4, alpha: 0.06 },
            { width: 2, alpha: 0.1 },
          ];

          for (const pass of glowPasses) {
            const style = `rgba(200,210,255,${flashOpacity * pass.alpha})`;
            ctx!.beginPath();
            ctx!.strokeStyle = style;
            ctx!.lineWidth = pass.width;
            for (const seg of boltSegments) {
              if (seg.depth === 0) {
                ctx!.moveTo(seg.x1, seg.y1);
                ctx!.lineTo(seg.x2, seg.y2);
              }
            }
            ctx!.stroke();

            ctx!.beginPath();
            ctx!.lineWidth = pass.width * 0.5;
            for (const seg of boltSegments) {
              if (seg.depth > 0) {
                ctx!.moveTo(seg.x1, seg.y1);
                ctx!.lineTo(seg.x2, seg.y2);
              }
            }
            ctx!.stroke();
          }

          const trunkStyle = `rgba(255,255,255,${flashOpacity * 0.3})`;
          ctx!.beginPath();
          ctx!.strokeStyle = trunkStyle;
          ctx!.lineWidth = 2.2;
          for (const seg of boltSegments) {
            if (seg.depth === 0) {
              ctx!.moveTo(seg.x1, seg.y1);
              ctx!.lineTo(seg.x2, seg.y2);
            }
          }
          ctx!.stroke();

          const branchStyle = `rgba(255,255,255,${flashOpacity * 0.15})`;
          ctx!.beginPath();
          ctx!.strokeStyle = branchStyle;
          ctx!.lineWidth = 0.8;
          for (const seg of boltSegments) {
            if (seg.depth > 0) {
              ctx!.moveTo(seg.x1, seg.y1);
              ctx!.lineTo(seg.x2, seg.y2);
            }
          }
          ctx!.stroke();

          // Sync border with lightning
          const b = Math.round(51 + flashOpacity * 204);
          const hex = b.toString(16).padStart(2, "0");
          const bc = `#${hex}${hex}${hex}`;
          banner.style.borderColor = bc;
          if (badge) badge.style.borderColor = bc;
        } else {
          banner.style.borderColor = "";
          if (badge) badge.style.borderColor = "";
        }
      }

      const color = isDark ? "255,255,255" : "0,0,0";
      const buckets: Drop[][] = [[], [], [], [], []];
      for (const drop of drops) {
        drop.x += SIN_A * drop.speed;
        drop.y += COS_A * drop.speed;

        if (drop.y > lh || drop.x < 0) {
          Object.assign(drop, createDrop());
          if (Math.random() > 0.5) {
            drop.y = -drop.length;
            drop.x = Math.random() * lw;
          } else {
            drop.x = lw + drop.length;
            drop.y = Math.random() * lh;
          }
        }

        const bi = Math.min(4, (drop.opacity * 5) | 0);
        buckets[bi].push(drop);
      }

      ctx!.lineWidth = 1;
      ctx!.lineCap = "butt";
      for (let bi = 0; bi < 5; bi++) {
        const bucket = buckets[bi];
        if (bucket.length === 0) continue;
        const avgOpacity = (bi + 0.5) / 5;
        ctx!.strokeStyle = `rgba(${color},${avgOpacity * currentOpacity})`;
        ctx!.beginPath();
        for (const drop of bucket) {
          const dx = SIN_A * drop.length;
          const dy = COS_A * drop.length;
          ctx!.moveTo(drop.x, drop.y);
          ctx!.lineTo(drop.x + dx, drop.y + dy);
        }
        ctx!.stroke();
      }

      animId = requestAnimationFrame(draw);
    }

    resize();
    for (let i = 0; i < DROP_COUNT; i++) {
      const d = createDrop();
      d.y = Math.random() * lh;
      drops.push(d);
    }

    if (isVisible) animId = requestAnimationFrame(draw);

    const ro = new ResizeObserver(() => resize());
    ro.observe(banner);

    return () => {
      cancelAnimationFrame(animId);
      ro.disconnect();
      io.disconnect();
      themeObserver.disconnect();
    };
  }

  document.addEventListener("astro:page-load", () => {
    initRailwayRain();
  });
</script>
<style is:global>
  .card_image {
    width: 66px;
    height: 66px;
  }

  #git-link {
    height: fit-content;
  }

  .card_image img {
    width: 100%;
    height: 100%;
    display: inline-block;
  }

  .sponsors_header {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
  }

  .sponsors {
    height: 100%;
  }

  .cards {
    display: grid;
    grid-auto-flow: column;
    grid-template-rows: 134px 134px;
    grid-auto-columns: 110px;
    height: 264px;
  }

  .hero {
    grid-template-rows: repeat(2, auto);
    grid-auto-columns: 110px;
    grid-gap: 6px;
  }

  .hero .styled_card {
    height: unset;
  }

  .gold {
    grid-template-rows: repeat(2, 112px);
    grid-auto-columns: 90px;
    grid-gap: 10px;
  }

  .silver {
    grid-template-rows: repeat(3, 74px);
    grid-auto-columns: 63px;
    grid-gap: 10px;
  }

  .bronze {
    grid-template-rows: repeat(5, 42px);
    grid-auto-columns: 42px;
    grid-gap: 10px;
  }

  .ramen {
    grid-template-rows: repeat(6, 38px);
    grid-auto-columns: 38px;
    grid-gap: 3px;
  }

  .coffee {
    grid-template-rows: repeat(7, 35px);
    grid-auto-columns: 35px;
    grid-gap: 3px;
  }

  .past {
    grid-template-rows: repeat(9, 25px);
    grid-auto-columns: 25px;
    grid-gap: 5px;
  }

  .sponsors_button_accent {
    margin: 0 auto;
    width: 212px;
    border-radius: 3px;
    color: #ffffff;
    font-size: 16px;
    font-weight: 700;
    line-height: 1;
    height: 48px;
    cursor: pointer;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border: none;
    background-color: #282b3b;
  }

  html[class~="dark"] .sponsors_button_accent {
    color: #282828;
    background-color: rgb(226, 232, 240);
  }

  .stream-link {
    text-decoration: underline;
    margin: 0 4px;
  }

  html[class~="dark"] .special-sponsors_wrap {
    background-color: #1c1c1c;
  }

  .special-sponsors_wrap {
    margin: 10px 0 0;
    background-color: #f8f8f8;
    padding: 15px 20px;
    margin-bottom: 40px;
    position: relative;
  }

  .special-sponsors_header {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
  }

  .special-sponsors_content {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    flex-direction: row;
  }

  .special-sponsors_cards {
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: 63px;
  }

  .special-sponsor_card {
    display: flex;
    align-items: center;
    flex-direction: column;
    gap: 6px;
  }

  html[class~="dark"] .special-sponsor_card_image {
    background: #282828;
    border: 1px solid #111111;
  }

  .special-sponsor_card_image {
    background-color: #ffffff;
    border: 1px solid #e8e8e8;
    border-radius: 50%;
  }

  html[class~="dark"] .special-sponsor_card_name {
    color: #e2e8f0;
  }

  .special-sponsor_card_name {
    color: #434a54;
    font-size: 14px;
    line-height: 14px;
  }

  html[class~="dark"] .light-image {
    display: block;
  }

  html[class~="dark"] .dark-image {
    display: none;
  }

  .light-image {
    display: none;
  }

  .dark-image {
    display: block;
  }

  .card_name {
    text-align: center;
    font-size: 14px;
    color: #434a54;
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    width: 100%;
    line-height: normal;
  }

  .with_name {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    gap: 6px;
  }

  html[class~="dark"] .card_name {
    color: #e2e8f0;
  }

  html[class~="dark"] .styled_card {
    background-color: #282828;
    border: 1px solid #111111;
  }

  .styled_card {
    padding: 10px 4px;
    border-radius: 4px;
    background-color: #ffffff;
    border: 1px solid #e8e8e8;
    height: 114.5px;
  }

  .styled_card_with_popover {
    position: relative;
  }

  .popover {
    position: fixed;
    top: 0;
    white-space: nowrap;
    left: 0;
    width: max-content;
    opacity: 0;
    pointer-events: none;
    font-size: 14px;
    font-weight: 500;
    padding: 4px 12px;
    background: white;
    border-radius: 4px;
    z-index: 999;
    box-shadow:
      0 0 0 0 #fff,
      0 0 0 1px rgba(0, 0, 0, 0.08),
      0 1px 2px 0 rgba(0, 0, 0, 0.1),
      0 2px 4px 0 rgba(0, 0, 0, 0.075);
    transition: opacity 0.3s;
  }

  html.dark .styled_card_with_popover .popover {
    background: #000;
    box-shadow:
      0 0 0 0 transparent,
      0 0 0 0 transparent,
      0 0 0 1px hsla(0, 0%, 100%, 0.2),
      0 1px 2px 0 rgba(0, 0, 0, 0.1),
      0 2px 4px 0 rgba(0, 0, 0, 0.075);
  }

  .styled_card_with_popover:hover .popover {
    opacity: 1;
  }

  .round-20 {
    border-radius: 20%;
  }

  .round-50 {
    border-radius: 50%;
  }

  html[class~="dark"] #avatar-dark {
    display: block;
  }

  html[class~="dark"] #avatar-light {
    display: none;
  }

  #avatar-dark {
    display: none;
  }

  #avatar-light {
    display: block;
  }

  .railway-section {
    flex-shrink: 0;
    height: 100%;
  }

  .railway-banner {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    text-decoration: none;
  }

  .railway-banner_content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 16px 20px;
    border-radius: 4px;
    background-color: #ffffff;
    border: 1px solid #e8e8e8;
    width: 240px;
    height: 144px;
    box-sizing: border-box;
    transition: border-color 0.2s;
    position: relative;
  }

  .railway-rain {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 0;
  }

  .railway-banner:hover .railway-banner_content {
    border-color: #aaaaaa;
  }

  html[class~="dark"] .railway-banner_content {
    background-color: #282828;
    border: 1px solid #333333;
    transition: border-color 0.05s;
  }

  .railway-banner_logo {
    display: flex;
    align-items: center;
    justify-content: center;
    flex: 1;
    position: relative;
    z-index: 1;
  }

  .railway-banner_logo img {
    height: 80px;
    width: auto;
  }

  .railway-logo-dark {
    display: none;
  }

  .railway-logo-light {
    display: block;
  }

  html[class~="dark"] .railway-logo-dark {
    display: block;
  }

  html[class~="dark"] .railway-logo-light {
    display: none;
  }

  .railway-banner_badge {
    font-size: 10px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: #888888;
    padding: 3px 8px;
    border-radius: 4px;
    background-color: #f0f0f0;
    border: 1px solid #e8e8e8;
    white-space: nowrap;
    position: absolute;
    z-index: 1;
    transform: translateY(50%);
    bottom: 0;
    transition: border-color 0.2s;
  }

  .railway-banner:hover .railway-banner_badge {
    border-color: #aaaaaa;
  }

  html[class~="dark"] .railway-banner_badge {
    color: #999999;
    background-color: #1c1c1c;
    border-color: #333333;
    transition: border-color 0.05s;
  }
</style>
<style>
  .container {
    width: 100%;
    margin: 160px auto 0;
    text-align: center;
    gap: 24px;
  }

  .title {
    font-size: 32px;
    font-weight: 600;
  }

  .description {
    font-size: 20px;
    font-weight: 500;
  }

  html[class~="dark"] .wrapper {
    background-color: #1c1c1c;
  }

  .wrapper {
    margin: 30px 0 40px;
    background-color: #f8f8f8;
    padding: 15px 0;
    position: relative;
  }

  .scroll {
    overflow: auto;
    -ms-overflow-style: none;
    scrollbar-width: none;
    display: flex;
    flex-direction: row;
    height: 306px;
    padding: 0 20px;
    gap: 80px;
  }

  .scroll::-webkit-scrollbar {
    display: none;
  }

  .gradient-left,
  .gradient-right {
    pointer-events: none;
    position: absolute;
    top: 0;
    height: 100%;
    width: 20px;
  }

  html[class~="dark"] .gradient-right {
    background: linear-gradient(
      to right,
      rgba(28, 28, 28, 0) 0%,
      rgba(28, 28, 28, 0.7) 50%,
      rgba(28, 28, 28, 1) 100%
    );
  }

  html[class~="dark"] .gradient-left {
    background: linear-gradient(
      to left,
      rgba(28, 28, 28, 0) 0%,
      rgba(28, 28, 28, 0.7) 50%,
      rgba(28, 28, 28, 1) 100%
    );
  }

  .gradient-left {
    left: 0;
    background: linear-gradient(
      to left,
      rgba(248, 248, 248, 0) 0%,
      rgba(248, 248, 248, 0.7) 50%,
      rgba(248, 248, 248, 1) 100%
    );
  }

  .gradient-right {
    right: 0;
    background: linear-gradient(
      to right,
      rgba(248, 248, 248, 0) 0%,
      rgba(248, 248, 248, 0.7) 50%,
      rgba(248, 248, 248, 1) 100%
    );
  }

  .type_header {
    white-space: nowrap;
    font-weight: 600;
    font-size: 12px;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
  }

  .emoji {
    line-height: 20px;
    font-size: 14px;
    padding-right: 4px;
  }

  .avatar {
    display: flex;
    flex-direction: row;
    align-items: center;
  }

  @media (max-width: 900px) {
    .title {
      font-size: 20px;
    }
    .description {
      font-size: 14px;
    }
  }

  @media (max-width: 767px) {
    .wrapper,
    .special-sponsors_wrap {
      margin-left: -24px;
      margin-right: -24px;
    }

    .scroll {
      gap: 60px;
    }
  }

  @media (max-width: 599px) {
    .container {
      gap: 20px;
    }

    .buttons {
      gap: 10px;
    }

    .sponsors_button_accent {
      font-size: 14px;
      height: 46px;
    }
  }
</style>
